---
title: "Machine Learning Project"
author: "Martin Halwachs"
date: "25 Mai 2017"
output:
  html_document:
    toc: TRUE
---

# requirements

- predict the `classe` variable  
- create report  
- describe how you **build the model**  
- describe how you use **cross validation**  
- estimate the **out of sample error**  
- explain why you made your choices  
- github repository  
    - R markdown file  
    - compiled HTM file  
    - less than 2000 words  
    - less than 5 figures  
    - submit with a gh-pages branch = allow online view of HTML  
    
for the quiz you will need to:

- predict 20 different test cases with your model  


# introduction
For this course project data will be used from http://groupware.les.inf.puc-rio.br/har. 6 participants were asked to perform barbell lifts correctly and incorrectly in 5 different ways. There activity was tracked by accelerometers on the belt, forearm, arm and dumbell. We will try to find a model, allowing to qualify a participant's quality of activity in terms of correctness.

# libraries
This project needs the following libraries. In case you don't have them installed, you may use `install.packages()` function
```{r libraries, message=FALSE, warning=FALSE}
library(dplyr)
```

# Preparing the data set
First training and test data is loaded from the web and into `trainData` and `testData`
```{r load data, message=FALSE, cache=TRUE}
trainURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testURL <- "http://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"

download.file(trainURL, destfile="training.csv", method="curl")
download.file(testURL, destfile="testing.csv", method="curl")

trainData <- read.table("training.csv", header=TRUE, sep=",", na.strings = "NA",
                        stringsAsFactors=FALSE)
testData <- read.table("testing.csv", header=TRUE, sep=",", na.strings = "NA",
                        stringsAsFactors=FALSE)
```

These data sets contain the following amount of data
```{r}
dim(trainData)
dim(testData)
```

# filtering variables
These columns are in the training, but not in the testing set
```{r}
train.but.not.in.test <- names(trainData)[!names(trainData) %in% names(testData)]
train.but.not.in.test
```

Therefore all data, but 'classe' are contained in the testing set, while testing contains the column `problem_id` (as column number of the data sets is equal). From all columns the ones with NAs in testing can be excluded from model building, as they allow no prediction:
```{r}
nas.in.testData <- apply(is.na(testData), 2, sum)
nas.in.testData <- nas.in.testData[nas.in.testData>0]
```

As the minimum number of NAs per variable is `r min(nas.in.testData)` and the testing set only contains 20 rows, these can all be excluded from training and testing data set.
```{r}
trainData <- trainData[,! names(trainData) %in% names(nas.in.testData)]
testData <- testData[,! names(testData) %in% names(nas.in.testData)]
```

This leaves `r dim(trainData)` variables in `trainData` and `testData` (including the predict)

Next `classe` and `user_name` are formatted to factors
```{r}
trainData$classe <- as.factor(trainData$classe)
trainData$user_name <- as.factor(trainData$user_name)
testData$user_name <- as.factor(testData$user_name)
```

Now the training data set looks like this
```{r}
str(trainData)
```








